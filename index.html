<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>Stock Disponible - Itelsa</title>
  <link rel="icon" href="icon.png" type="image/png" />
  <link rel="stylesheet" href="styles.css" />
  <!-- Librería SheetJS para leer archivos Excel en el navegador -->
  <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
</head>
<body>
  <div class="app-container">
    <header class="app-header">
      <img src="logo.png" alt="Logo de Itelsa" class="app-logo" />
      <p class="app-subtitle">
        <span class="subtitle-icon" aria-hidden="true">✦</span>
        <span class="subtitle-text">Catálogo con Stock Disponible</span>
      </p>
    </header>

    <div class="panel" id="data-panel">
      <div class="data-status" id="data-status" style="display:none;">
        <span class="status-badge" id="status-badge">Estado</span>
        <span class="status-text" id="status-text"></span>
      </div>
      <label class="file-label">
        <span class="btn-icon" aria-hidden="true">
          <svg viewBox="0 0 24 24" role="presentation" focusable="false">
            <path d="M4 5.5A1.5 1.5 0 0 1 5.5 4h5.086c.398 0 .78.158 1.06.439l1.914 1.914c.28.28.662.437 1.06.437H18.5A1.5 1.5 0 0 1 20 8.29V18.5a1.5 1.5 0 0 1-1.5 1.5h-13A1.5 1.5 0 0 1 4 18.5z" fill="currentColor" />
          </svg>
        </span>
        <span class="btn-label">Seleccionar archivo Excel</span>
        <input type="file" id="file-input" accept=".xlsx,.xls,.csv" />
      </label>

      <div id="file-info" class="file-info">
        Cargando datos...
      </div>

      <div class="data-actions" id="data-actions" style="display:none;">
        <button id="reload-json-btn" type="button" class="secondary-btn">
          <span class="btn-icon" aria-hidden="true">
            <svg viewBox="0 0 24 24" role="presentation" focusable="false">
              <path d="M19 8l-4 4V9H9a4 4 0 0 0 0 8h1v2H9a6 6 0 0 1 0-12h6V4z" fill="currentColor" />
            </svg>
          </span>
          <span class="btn-label">Reintentar precarga JSON</span>
        </button>
        <button id="change-data-btn" type="button" class="secondary-btn">
          <span class="btn-icon" aria-hidden="true">
            <svg viewBox="0 0 24 24" role="presentation" focusable="false">
              <path d="M12 6V3L8 7l4 4V8c2.757 0 5 2.243 5 5 0 1.02-.31 1.97-.84 2.76l1.46 1.46A6.96 6.96 0 0 0 19 13c0-3.86-3.14-7-7-7zm-5.62.24L4.92 4.78A6.96 6.96 0 0 0 5 13c0 3.86 3.14 7 7 7v3l4-4-4-4v3c-2.757 0-5-2.243-5-5 0-1.02.31-1.97.84-2.76z" fill="currentColor"/>
            </svg>
          </span>
          <span class="btn-label">Cambiar / actualizar datos</span>
        </button>

        <button id="view-json-btn" type="button" class="secondary-btn">
          <span class="btn-icon" aria-hidden="true">
            <svg viewBox="0 0 24 24" role="presentation" focusable="false">
              <path d="M7 4h10a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2zm0 2v12h10V6H7zm2 2h6v2H9V8zm0 4h6v2H9v-2z" fill="currentColor" />
            </svg>
          </span>
          <span class="btn-label">Ver JSON</span>
        </button>
      </div>

      <!-- Buscador general (todas las columnas) -->
      <div class="search-area" id="search-area" style="display:none;">
        <input
          type="text"
          id="search-input"
          placeholder="Buscar texto en cualquier columna..."
        />
        <span id="results-count"></span>
      </div>

      <!-- Buscador específico por CODIGO -->
      <div class="search-code-area" id="search-code-area" style="display:none;">
        <label for="code-input">Buscar por CODIGO:</label>
        <div class="search-code-row">
          <input
            type="text"
            id="code-input"
            placeholder="Ej: A123"
          />
          <button id="code-btn">
            <span class="btn-icon" aria-hidden="true">
              <svg viewBox="0 0 24 24" role="presentation" focusable="false">
                <path d="M11 4a7 7 0 1 1 0 14 7 7 0 0 1 0-14zm0 2a5 5 0 1 0 0 10 5 5 0 0 0 0-10zm6.707 9.293 3.5 3.5-1.414 1.414-3.5-3.5z" fill="currentColor" />
              </svg>
            </span>
            <span class="btn-label">Buscar</span>
          </button>
          <button id="clear-btn">
            <span class="btn-icon" aria-hidden="true">
              <svg viewBox="0 0 24 24" role="presentation" focusable="false">
                <path d="M6 6h12v2H6zm2 3h8l-.9 9.1a2 2 0 0 1-1.99 1.9H10.89a2 2 0 0 1-1.99-1.9zM9 4h6v1H9z" fill="currentColor" />
              </svg>
            </span>
            <span class="btn-label">Limpiar</span>
          </button>
        </div>
        <div id="code-result" class="code-result">
          Ingrese un código y presione Buscar.
        </div>
      </div>
    </div>

    <!-- Tabla general -->
    <div class="table-wrapper">
      <table id="results-table">
        <thead id="table-head"></thead>
        <tbody id="table-body"></tbody>
      </table>
    </div>
  </div>

  <div class="modal" id="json-modal" aria-hidden="true">
    <div class="modal-overlay" data-close="true"></div>
    <div class="modal-content" role="dialog" aria-modal="true" aria-labelledby="json-modal-title">
      <div class="modal-header">
        <h2 id="json-modal-title">JSON de stock</h2>
        <button type="button" class="modal-close" id="json-close-btn" aria-label="Cerrar">×</button>
      </div>
      <pre class="json-pre" id="json-pre">Cargando...</pre>
    </div>
  </div>

  <script src="app.js"></script>
</body>
</html>

